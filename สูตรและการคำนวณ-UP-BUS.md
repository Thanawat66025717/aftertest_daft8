# üìê ‡∏™‡∏π‡∏ï‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå UP BUS
### ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡∏Ñ‡∏ô ‚Äî ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≠‡∏ö

---

## 1. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ß‡∏•‡∏≤‡∏ñ‡∏∂‡∏á‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì (ETA)

üìÅ ‡πÑ‡∏ü‡∏•‡πå: `notification_service.dart`
üìç ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà **35‚Äì41** (‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `calculateEtaSeconds`)

**‡∏û‡∏π‡∏î‡∏á‡πà‡∏≤‡∏¢‡πÜ:** ‡πÄ‡∏£‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤ "‡∏£‡∏ñ‡∏à‡∏∞‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡∏≠‡∏µ‡∏Å‡∏Å‡∏µ‡πà‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ" ‡∏Å‡πá‡πÄ‡∏≠‡∏≤ **‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á ‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß** ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏π‡∏ï‡∏£‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå ‡∏°.‡∏ï‡πâ‡∏ô‡πÄ‡∏•‡∏¢ ‡∏Ñ‡∏∑‡∏≠ **‡πÄ‡∏ß‡∏•‡∏≤ = ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á √∑ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß**

- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡πâ‡∏£‡∏ñ‡∏ö‡∏±‡∏™‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ **35 ‡∏Å‡∏°./‡∏ä‡∏°.**
- ‡πÅ‡∏ï‡πà‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡πÄ‡∏£‡∏≤‡πÄ‡∏õ‡πá‡∏ô**‡πÄ‡∏°‡∏ï‡∏£** ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏õ‡πá‡∏ô **‡πÄ‡∏°‡∏ï‡∏£/‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ** ‡∏Å‡πà‡∏≠‡∏ô
- ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏õ‡∏•‡∏á (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **39**): ‡πÄ‡∏≠‡∏≤ 35 √ó 1000 (‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏ï‡∏£) ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢ 3600 (‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ) = ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì **9.72 ‡∏°./‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ**
- ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ETA (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **40**): ‡πÄ‡∏≠‡∏≤‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏•‡πâ‡∏ß‡∏õ‡∏±‡∏î‡πÄ‡∏®‡∏©

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:** ‡∏ñ‡πâ‡∏≤‡∏£‡∏ñ‡∏≠‡∏¢‡∏π‡πà‡∏´‡πà‡∏≤‡∏á 500 ‡πÄ‡∏°‡∏ï‡∏£ ‚Üí 500 √∑ 9.72 = ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì **51 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ** ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏ñ‡∏à‡∏∞‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡πÉ‡∏ô 51 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö

---

## 2. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á (2 ‡∏ß‡∏¥‡∏ò‡∏µ)

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: Haversine ‚Äî ‡∏´‡∏≤‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á "‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á" ‡∏ö‡∏ô‡πÇ‡∏•‡∏Å‡∏Å‡∏•‡∏°

üìÅ ‡πÑ‡∏ü‡∏•‡πå: `global_location_service.dart`
üìç ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà **225** (‡∏™‡∏£‡πâ‡∏≤‡∏á Distance object) ‡πÅ‡∏•‡∏∞ **233‚Äì235** (‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏£‡∏¥‡∏á)

**‡∏û‡∏π‡∏î‡∏á‡πà‡∏≤‡∏¢‡πÜ:** ‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ library `latlong2` ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏•‡∏≤‡∏™ `Distance()` ‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡πâ ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á‡∏°‡∏±‡∏ô‡πÉ‡∏ä‡πâ‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ **Haversine** ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 2 ‡∏à‡∏∏‡∏î‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏ß‡πÇ‡∏•‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö

- ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ **‡∏•‡∏∞‡∏ï‡∏¥‡∏à‡∏π‡∏î-‡∏•‡∏≠‡∏á‡∏à‡∏¥‡∏à‡∏π‡∏î** ‡∏Ç‡∏≠‡∏á 2 ‡∏à‡∏∏‡∏î (‡πÄ‡∏ä‡πà‡∏ô ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡∏Å‡∏±‡∏ö ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏£‡∏ñ)
- ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡πÅ‡∏ö‡∏ö "‡∏•‡∏≤‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á" ‡∏ú‡πà‡∏≤‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡πÇ‡∏•‡∏Å‡∏ó‡∏µ‡πà‡πÇ‡∏Ñ‡πâ‡∏á
- ‡πÑ‡∏î‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏õ‡πá‡∏ô **‡πÄ‡∏°‡∏ï‡∏£**
- **‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î:** ‡∏°‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞ "‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á" ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏£‡∏∞‡∏¢‡∏∞‡∏ï‡∏≤‡∏°‡∏ñ‡∏ô‡∏ô‡∏à‡∏£‡∏¥‡∏á

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á "‡∏ï‡∏≤‡∏°‡∏ñ‡∏ô‡∏ô‡∏à‡∏£‡∏¥‡∏á"

üìÅ ‡πÑ‡∏ü‡∏•‡πå: `route_service.dart`
üìç ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà **18‚Äì57** (‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `getRoadDistance`)

**‡∏û‡∏π‡∏î‡∏á‡πà‡∏≤‡∏¢‡πÜ:** ‡πÄ‡∏£‡∏≤‡∏™‡πà‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î 2 ‡∏à‡∏∏‡∏î‡πÑ‡∏õ‡πÉ‡∏´‡πâ **OpenRouteService API** ‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á "‡∏ï‡∏≤‡∏°‡∏ñ‡∏ô‡∏ô‡∏à‡∏£‡∏¥‡∏á" ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏ï‡∏£ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Google Maps ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡πÉ‡∏´‡πâ

üìç Fallback ‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **229‚Äì235** ‡πÉ‡∏ô `global_location_service.dart`

**Fallback (‡πÅ‡∏ú‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á):** ‡∏ñ‡πâ‡∏≤ API ‡∏•‡πà‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏≠‡∏ö‡∏ä‡πâ‡∏≤ (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **233‚Äì235**) ‚Üí ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÉ‡∏ä‡πâ Haversine (‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á) ‡πÅ‡∏ó‡∏ô‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏õ‡∏Ñ‡πâ‡∏≤‡∏á

---

## 3. ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö 4 ‡∏Ç‡∏±‡πâ‡∏ô (Alert Stage)

üìÅ ‡πÑ‡∏ü‡∏•‡πå: `global_location_service.dart`
üìç ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà **321‚Äì359** (‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô `_updateClosestBus`)

**‡∏û‡∏π‡∏î‡∏á‡πà‡∏≤‡∏¢‡πÜ:** ‡∏û‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ETA ‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß (‡∏à‡∏≤‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏Ç‡πâ‡∏≠ 1) ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡πÄ‡∏≠‡∏≤‡∏°‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ß‡πà‡∏≤ "‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÑ‡∏´‡∏ô" ‡∏ñ‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡πá‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö **‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î** ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

| ‡∏Ç‡∏±‡πâ‡∏ô | ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç | ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ß‡πà‡∏≤ | üìç ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î |
|------|----------|-------------|-----------|
| 1 | ETA ‚â§ 5 ‡∏ô‡∏≤‡∏ó‡∏µ (300 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ) | "‡∏≠‡∏µ‡∏Å 5 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏à‡∏∞‡∏ñ‡∏∂‡∏á" | **353‚Äì358** |
| 2 | ETA ‚â§ 3 ‡∏ô‡∏≤‡∏ó‡∏µ (180 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ) | "‡∏≠‡∏µ‡∏Å 3 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏à‡∏∞‡∏ñ‡∏∂‡∏á" | **346‚Äì351** |
| 3 | ETA ‚â§ 1 ‡∏ô‡∏≤‡∏ó‡∏µ (60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ) | "‡∏≠‡∏µ‡∏Å 1 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏à‡∏∞‡∏ñ‡∏∂‡∏á" | **339‚Äì344** |
| 4 | ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á ‚â§ 250 ‡πÄ‡∏°‡∏ï‡∏£ | "‡∏£‡∏ñ‡πÉ‡∏Å‡∏•‡πâ‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡πÅ‡∏•‡πâ‡∏ß!" | **327‚Äì337** |

**‡∏à‡∏∏‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 325):** ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏à‡∏∞ **‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏Ñ‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏ï‡πà‡∏≠‡∏Ñ‡∏±‡∏ô** ‡∏Ñ‡∏£‡∏±‡∏ö ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ô‡∏à‡∏∞ spam ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‚Äî ‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ `_lastAlertStage` ‡∏à‡∏≥‡πÑ‡∏ß‡πâ‡∏ß‡πà‡∏≤‡∏Ñ‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏ñ‡∏∂‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡πÑ‡∏´‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡∏ñ‡πâ‡∏≤‡πÅ‡∏à‡πâ‡∏á‡∏Ç‡∏±‡πâ‡∏ô 2 ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πâ‡∏≥ ‡∏à‡∏∞‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ‡πÅ‡∏à‡πâ‡∏á‡∏Ç‡∏±‡πâ‡∏ô 3 ‡πÄ‡∏•‡∏¢

---

## 4. ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏£‡∏ñ‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏≤‡πÄ‡∏£‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡∏¥‡πà‡∏á‡∏´‡∏ô‡∏µ (Direction Detection)

üìÅ ‡πÑ‡∏ü‡∏•‡πå: `global_location_service.dart`
üìç ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà **263‚Äì307** (‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô `_updateClosestBus`)

**‡∏û‡∏π‡∏î‡∏á‡πà‡∏≤‡∏¢‡πÜ:** ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏ñ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö ‡∏°‡∏±‡∏ô‡∏à‡∏∞ **‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡∏£‡∏ñ‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏≤‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏£‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡∏¥‡πà‡∏á‡∏≠‡∏≠‡∏Å** ‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡∏Ñ‡∏∑‡∏≠:

- ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **270‚Äì274**: ‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏¢‡∏∞‡∏à‡∏≤‡∏Å **‡∏£‡∏ñ‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢** (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ñ‡∏∂‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏£‡∏≤)
- ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **276‚Äì277**: ‡∏î‡∏∂‡∏á **‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏¢‡∏∞‡∏£‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô** ‡∏°‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö
- ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **280**: ‡∏ñ‡πâ‡∏≤‡∏£‡∏∞‡∏¢‡∏∞ **‡∏•‡∏î‡∏•‡∏á** ‡∏´‡∏£‡∏∑‡∏≠ **‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°** ‚Üí ‡∏£‡∏ñ‡∏Å‡∏≥‡∏•‡∏±‡∏á **‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏≤** ‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢ ‚úÖ
- ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **287**: ‡∏ñ‡πâ‡∏≤‡∏£‡∏∞‡∏¢‡∏∞ **‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô** ‚Üí ‡∏£‡∏ñ **‡∏ß‡∏¥‡πà‡∏á‡∏´‡∏ô‡∏µ** ‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢ ‚ùå ‚Üí ‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ
- ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **306**: ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤

‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏£‡∏≤‡∏î‡∏π‡∏ß‡πà‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏´‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏î‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ ‡∏Å‡πá‡∏î‡∏π‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏¢‡∏∞‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡πÉ‡∏Å‡∏•‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏Å‡∏•‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö

---

## 5. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á (Weighted Score)

üìÅ ‡πÑ‡∏ü‡∏•‡πå: `route_planner_service.dart`
üìç ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà **182‚Äì198** (‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `_calculateWeightedScore`)

**‡∏û‡∏π‡∏î‡∏á‡πà‡∏≤‡∏¢‡πÜ:** ‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏™‡πâ‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏™‡πâ‡∏ô‡πÑ‡∏´‡∏ô? ‡∏Å‡πá‡πÉ‡∏ä‡πâ **‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô** ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏¢‡∏¥‡πà‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô **‡∏ô‡πâ‡∏≠‡∏¢** ‡∏¢‡∏¥‡πà‡∏á **‡∏î‡∏µ**

‡∏™‡∏π‡∏ï‡∏£: **‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô = ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡∏±‡πà‡∏á + ‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö**

‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡∏°‡∏µ 2 ‡∏ï‡∏±‡∏ß:
- **‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡∏ß‡∏ô‡∏£‡∏ñ** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **186‚Äì188**): ‡∏ñ‡πâ‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡∏±‡πà‡∏á‡∏ß‡∏ô‡∏£‡∏≠‡∏ö ‚Üí ‡πÇ‡∏î‡∏ô **+20** ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏•‡∏¢ (‡∏´‡∏ô‡∏±‡∏Å‡∏°‡∏≤‡∏Å ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏™‡∏µ‡∏¢‡πÄ‡∏ß‡∏•‡∏≤)
- **‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡πà‡∏≠‡∏£‡∏ñ** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **192‚Äì194**): ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏≤‡∏¢ ‚Üí ‡πÇ‡∏î‡∏ô **+5** ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≠‡∏Ñ‡∏£‡∏±‡πâ‡∏á (‡∏û‡∏≠‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡∏£‡∏ñ‡πÉ‡∏´‡∏°‡πà)
- **‡∏£‡∏ß‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **196‚Äì197**): ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î + penalty = ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
- **‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á A:** ‡∏ô‡∏±‡πà‡∏á S1 ‡∏ï‡∏£‡∏á‡πÑ‡∏õ 8 ‡∏õ‡πâ‡∏≤‡∏¢ ‚Üí ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô = 8 + 0 + 0 = **8** ‚úÖ ‡∏î‡∏µ‡∏™‡∏∏‡∏î
- **‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á B:** ‡∏ô‡∏±‡πà‡∏á S1 ‡∏ï‡πà‡∏≠ S2 ‡∏£‡∏ß‡∏° 5 ‡∏õ‡πâ‡∏≤‡∏¢ ‡πÅ‡∏ï‡πà‡∏ï‡πà‡∏≠‡∏£‡∏ñ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‚Üí ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô = 5 + 0 + 5 = **10**
- **‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á C:** ‡∏ô‡∏±‡πà‡∏á S1 ‡∏ß‡∏ô‡∏•‡∏π‡∏õ 6 ‡∏õ‡πâ‡∏≤‡∏¢ ‚Üí ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô = 6 + 20 + 0 = **26** ‚ùå ‡πÅ‡∏¢‡πà‡∏™‡∏∏‡∏î

‚Üí ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÑ‡∏õ‡∏°‡∏≤‡∏Å ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ **‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á A** ‡∏Å‡πà‡∏≠‡∏ô

---

## 6. ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≤‡∏á (Linear vs Circular)

üìÅ ‡πÑ‡∏ü‡∏•‡πå: `route_planner_service.dart`
üìç ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà **266‚Äì278** (‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `_calculateStopCount`)

**‡∏û‡∏π‡∏î‡∏á‡πà‡∏≤‡∏¢‡πÜ:** ‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏±‡∏ö‡∏ß‡πà‡∏≤ "‡∏à‡∏≤‡∏Å‡∏õ‡πâ‡∏≤‡∏¢ A ‡∏ñ‡∏∂‡∏á‡∏õ‡πâ‡∏≤‡∏¢ B ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏µ‡πà‡∏õ‡πâ‡∏≤‡∏¢" ‡∏°‡∏µ 2 ‡∏Å‡∏£‡∏ì‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö:

**‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà 1 ‚Äî ‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 272‚Äì273):** ‡∏ñ‡πâ‡∏≤‡∏õ‡πâ‡∏≤‡∏¢ A ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡πà‡∏≠‡∏ô B ‡πÉ‡∏ô‡∏•‡∏≥‡∏î‡∏±‡∏ö ‡∏Å‡πá‡πÅ‡∏Ñ‡πà **‡πÄ‡∏≠‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á B ‡∏•‡∏ö A**
- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: A ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà 2, B ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà 5 ‚Üí 5 - 2 = **3 ‡∏õ‡πâ‡∏≤‡∏¢**

**‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà 2 ‚Äî ‡∏ß‡∏ô‡∏•‡∏π‡∏õ (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 274‚Äì276):** ‡∏ñ‡πâ‡∏≤ A ‡∏≠‡∏¢‡∏π‡πà **‡∏´‡∏•‡∏±‡∏á** B ‡πÉ‡∏ô‡∏•‡∏≥‡∏î‡∏±‡∏ö ‡πÅ‡∏ï‡πà‡∏™‡∏≤‡∏¢‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á‡∏Å‡∏•‡∏° ‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á "‡∏ô‡∏±‡πà‡∏á‡∏ß‡∏ô‡∏Ç‡πâ‡∏≤‡∏°‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô"
- ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ô‡∏±‡∏ö: ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å A ‡πÑ‡∏õ‡∏à‡∏ô‡∏™‡∏∏‡∏î‡∏™‡∏≤‡∏¢ ‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏ß‡∏Å‡∏à‡∏≤‡∏Å‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏°‡∏≤‡∏ñ‡∏∂‡∏á B
- ‡∏™‡∏π‡∏ï‡∏£: **(‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î - 1 - ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á A) + ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á B**
- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏™‡∏≤‡∏¢ S2 ‡∏°‡∏µ 13 ‡∏õ‡πâ‡∏≤‡∏¢, A ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á 10, B ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á 3 ‚Üí (12 - 10) + 3 = **5 ‡∏õ‡πâ‡∏≤‡∏¢**

---

## 7. ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏™‡∏≤‡∏¢‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á‡∏Å‡∏•‡∏°‡πÑ‡∏´‡∏° (Circular Route)

üìÅ ‡πÑ‡∏ü‡∏•‡πå: `route_planner_service.dart`
üìç ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà **260‚Äì263** (‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `_isCircular`)

**‡∏û‡∏π‡∏î‡∏á‡πà‡∏≤‡∏¢‡πÜ:** ‡∏î‡∏π‡∏á‡πà‡∏≤‡∏¢‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **262** ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ **‡∏õ‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏Å‡∏Å‡∏±‡∏ö‡∏õ‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡πâ‡∏≤‡∏¢‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡πÑ‡∏´‡∏°** ‚Üí ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πà‡∏Å‡πá‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ß‡∏á‡∏Å‡∏•‡∏°
- **S2:** ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà PKY ‚Üí ‡∏ß‡∏ô‡πÑ‡∏õ ‚Üí ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤ PKY ‚Üí ‚úÖ ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á‡∏Å‡∏•‡∏°
- **S1-AM:** ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≠ ‚Üí ‡∏ß‡∏ô‡πÑ‡∏õ ‚Üí ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≠ ‚Üí ‚úÖ ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á‡∏Å‡∏•‡∏°

---

## 8. ‡∏£‡∏∞‡∏ö‡∏ö Cache (‡∏à‡∏≥‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡πà‡∏≤‡πÑ‡∏ß‡πâ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡∏ã‡πâ‡∏≥)

üìÅ ‡πÑ‡∏ü‡∏•‡πå: `route_service.dart`
üìç ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà **13** (‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏® cache map), **14** (‡∏Å‡∏≥‡∏´‡∏ô‡∏î TTL 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ), **23‚Äì28** (‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ cache ‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏≠‡∏≤‡∏¢‡∏∏‡πÑ‡∏´‡∏°)

**‡∏û‡∏π‡∏î‡∏á‡πà‡∏≤‡∏¢‡πÜ:** ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏à‡∏≤‡∏Å API ‡∏à‡∏∞ **‡∏à‡∏≥‡∏ú‡∏•‡πÑ‡∏ß‡πâ 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ** ‡∏Ñ‡∏£‡∏±‡∏ö (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **14**) ‡∏ñ‡πâ‡∏≤‡∏ñ‡∏≤‡∏°‡∏ã‡πâ‡∏≥‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‚Üí ‡πÄ‡∏≠‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡πÄ‡∏•‡∏¢ (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **26**) ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡πÉ‡∏´‡∏°‡πà ‡∏ä‡πà‡∏ß‡∏¢ **‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô API call** ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏õ **‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô**

‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏ä‡πá‡∏Ñ (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **25**): ‡πÄ‡∏≠‡∏≤ **‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡∏•‡∏ö ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà cache ‡πÑ‡∏ß‡πâ** ‡∏ñ‡πâ‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‚Üí ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡πà‡∏≤‡πÑ‡∏î‡πâ ‡∏ñ‡πâ‡∏≤‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ ‚Üí ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡πÉ‡∏´‡∏°‡πà

---

## 9. ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏ñ (Operating Hours)

üìÅ ‡πÑ‡∏ü‡∏•‡πå: `bus_route_data.dart`
üìç ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà **43‚Äì55** (‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `isActiveAt`)

**‡∏û‡∏π‡∏î‡∏á‡πà‡∏≤‡∏¢‡πÜ:** ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡∏≤‡∏¢‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ "‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏≤‡∏¢‡∏ô‡∏µ‡πâ‡∏ß‡∏¥‡πà‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏´‡∏°"

- **‡∏Å‡∏£‡∏ì‡∏µ‡∏õ‡∏Å‡∏ï‡∏¥** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **47‚Äì48**): ‡πÄ‡∏ä‡πà‡∏ô S1-AM 05:00‚Äì14:00 ‡∏î‡∏π‡∏á‡πà‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏ï‡πâ‡∏≠‡∏á **‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 5 ‡∏ñ‡∏∂‡∏á 14**
- **‡∏Å‡∏£‡∏ì‡∏µ‡∏Ç‡πâ‡∏≤‡∏°‡∏ß‡∏±‡∏ô** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **49‚Äì51**): ‡πÄ‡∏ä‡πà‡∏ô S1-PM 14:00‚Äì00:00 ‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏¥‡∏î‡∏ï‡πà‡∏≤‡∏á‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á ‡∏Ñ‡∏∑‡∏≠‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏ï‡πâ‡∏≠‡∏á **‚â• 14 ‡∏´‡∏£‡∏∑‡∏≠ < 0** (‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏Ñ‡∏∑‡∏ô)
- **‡∏Å‡∏£‡∏ì‡∏µ‡∏ß‡∏¥‡πà‡∏á‡∏ï‡∏•‡∏≠‡∏î** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **44**): ‡∏ñ‡πâ‡∏≤ startHour ‡∏Å‡∏±‡∏ö endHour ‡πÄ‡∏õ‡πá‡∏ô null ‚Üí return true ‡πÄ‡∏•‡∏¢ (‡πÄ‡∏ä‡πà‡∏ô S2, S3)

| ‡∏™‡∏≤‡∏¢ | ‡πÄ‡∏£‡∏¥‡πà‡∏° | ‡∏à‡∏ö | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
|-----|-------|-----|----------|
| S1-AM | 05:00 | 14:00 | ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô PKY |
| S1-PM | 14:00 | 00:00 | ‡∏ú‡πà‡∏≤‡∏ô PKY (‡∏Ç‡πâ‡∏≤‡∏°‡∏ß‡∏±‡∏ô) |
| S2 | ‚Äî | ‚Äî | ‡∏ß‡∏¥‡πà‡∏á‡∏ï‡∏•‡∏≠‡∏î‡∏ß‡∏±‡∏ô |
| S3 | ‚Äî | ‚Äî | ‡∏ß‡∏¥‡πà‡∏á‡∏ï‡∏•‡∏≠‡∏î‡∏ß‡∏±‡∏ô |

---

## 10. ‡∏´‡∏≤‡∏à‡∏∏‡∏î‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏≤‡∏¢ (Set Intersection)

üìÅ ‡πÑ‡∏ü‡∏•‡πå: `route_planner_service.dart`
üìç ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà **574‚Äì581** (‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `_findTransferPoints`)

**‡∏û‡∏π‡∏î‡∏á‡πà‡∏≤‡∏¢‡πÜ:** ‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏∞‡∏ï‡πà‡∏≠‡∏£‡∏ñ ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤‡∏ß‡πà‡∏≤ "‡∏õ‡πâ‡∏≤‡∏¢‡πÑ‡∏´‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏™‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á 2 ‡∏™‡∏≤‡∏¢" ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏≠:
- ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **578**: ‡πÄ‡∏≠‡∏≤‡∏õ‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏¢ 1 ‡∏°‡∏≤‡∏ó‡∏≥‡πÄ‡∏õ‡πá‡∏ô Set
- ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **579**: ‡πÄ‡∏≠‡∏≤‡∏õ‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏¢ 2 ‡∏°‡∏≤‡∏ó‡∏≥‡πÄ‡∏õ‡πá‡∏ô Set
- ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î **580**: ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `.intersection()` ‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà **‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô** ‚Äî ‡∏ó‡∏≤‡∏á‡∏Ñ‡∏ì‡∏¥‡∏ï‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ **‡∏≠‡∏¥‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏Å‡∏ä‡∏±‡∏ô** ‡∏Ç‡∏≠‡∏á 2 ‡πÄ‡∏ã‡∏ï‡∏Ñ‡∏£‡∏±‡∏ö

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
- ‡∏™‡∏≤‡∏¢ S1-AM ‡∏ú‡πà‡∏≤‡∏ô: ‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≠, ‡∏ß‡∏¥‡∏®‡∏ß‡∏∞, ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°, ‡∏≠‡∏ò‡∏¥‡∏Å‡∏≤‡∏£, ‡∏®‡∏¥‡∏•‡∏õ‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå, ‡∏Ñ‡∏ì‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡πå
- ‡∏™‡∏≤‡∏¢ S2 ‡∏ú‡πà‡∏≤‡∏ô: PKY, UB99, ‡πÄ‡∏ß‡∏µ‡∏¢‡∏á, ‡∏™‡∏á‡∏ß‡∏ô, ‡∏™‡∏≤‡∏ò‡∏¥‡∏ï, ‡∏®‡∏¥‡∏•‡∏õ‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå, ‡∏Ñ‡∏ì‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡πå, ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°, ‡∏≠‡∏ò‡∏¥‡∏Å‡∏≤‡∏£
- **‡∏õ‡πâ‡∏≤‡∏¢‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô** = {‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°, ‡∏≠‡∏ò‡∏¥‡∏Å‡∏≤‡∏£, ‡∏®‡∏¥‡∏•‡∏õ‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå, ‡∏Ñ‡∏ì‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡πå} ‚Üí ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏≤‡∏¢‡πÑ‡∏î‡πâ **4 ‡∏à‡∏∏‡∏î**

---

## ‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÇ‡∏Ñ‡πâ‡∏î

| # | ‡∏™‡∏π‡∏ï‡∏£/‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î | ‡πÑ‡∏ü‡∏•‡πå | ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î | ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô |
|---|-------------|------|--------|----------|
| 1 | ETA (‡πÄ‡∏ß‡∏•‡∏≤ = ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á √∑ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß) | notification_service.dart | 35‚Äì41 | `calculateEtaSeconds` |
| 2a | Haversine (‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á) | global_location_service.dart | 225, 233‚Äì235 | `_updateClosestBus` |
| 2b | Road Distance (‡∏£‡∏∞‡∏¢‡∏∞‡∏ï‡∏≤‡∏°‡∏ñ‡∏ô‡∏ô) | route_service.dart | 18‚Äì57 | `getRoadDistance` |
| 3 | Alert Stage (4 ‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î) | global_location_service.dart | 321‚Äì359 | `_updateClosestBus` |
| 4 | Direction Detection (‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤/‡∏´‡∏ô‡∏µ) | global_location_service.dart | 263‚Äì307 | `_updateClosestBus` |
| 5 | Weighted Score (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á) | route_planner_service.dart | 182‚Äì198 | `_calculateWeightedScore` |
| 6 | Stop Count (‡∏ô‡∏±‡∏ö‡∏õ‡πâ‡∏≤‡∏¢) | route_planner_service.dart | 266‚Äì278 | `_calculateStopCount` |
| 7 | Circular Route (‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡∏á‡∏Å‡∏•‡∏°) | route_planner_service.dart | 260‚Äì263 | `_isCircular` |
| 8 | Cache TTL (‡∏à‡∏≥‡∏Ñ‡πà‡∏≤ 30 ‡∏ß‡∏¥) | route_service.dart | 13‚Äì28 | `getRoadDistance` |
| 9 | Operating Hours (‡πÄ‡∏ß‡∏•‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£) | bus_route_data.dart | 43‚Äì55 | `isActiveAt` |
| 10 | Set Intersection (‡∏à‡∏∏‡∏î‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏≤‡∏¢) | route_planner_service.dart | 574‚Äì581 | `_findTransferPoints` |
