<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UP BUS - Line-by-Line Code Explanation</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Sarabun', 'Segoe UI', sans-serif;
    font-size: 14px;
    line-height: 1.7;
    color: #2d2d2d;
    background: #f5f0ff;
    padding: 20px;
  }
  .container {
    max-width: 900px;
    margin: 0 auto;
    background: #fff;
    border-radius: 16px;
    padding: 40px;
    box-shadow: 0 4px 30px rgba(128,0,128,0.08);
  }
  h1 {
    font-size: 2em;
    color: #6a1b9a;
    border-bottom: 3px solid #ce93d8;
    padding-bottom: 12px;
    margin: 30px 0 20px;
  }
  h2 {
    font-size: 1.4em;
    color: #7b1fa2;
    margin: 25px 0 12px;
    padding: 8px 12px;
    background: linear-gradient(90deg, #f3e5f5, transparent);
    border-left: 4px solid #9c27b0;
    border-radius: 4px;
  }
  h3 {
    font-size: 1.15em;
    color: #8e24aa;
    margin: 18px 0 8px;
  }
  p { margin: 8px 0; }
  ul, ol { margin: 8px 0 8px 24px; }
  li { margin: 4px 0; }
  table {
    border-collapse: collapse;
    width: 100%;
    margin: 12px 0;
    font-size: 13px;
  }
  th {
    background: #9c27b0;
    color: #fff;
    padding: 8px 12px;
    text-align: left;
    font-weight: 600;
  }
  td {
    border: 1px solid #e0d0ee;
    padding: 6px 12px;
  }
  tr:nth-child(even) { background: #faf5ff; }
  code {
    background: #f3e5f5;
    padding: 2px 6px;
    border-radius: 4px;
    font-family: 'Consolas', 'Courier New', monospace;
    font-size: 13px;
    color: #6a1b9a;
  }
  pre {
    background: #1e1e2e;
    color: #cdd6f4;
    padding: 16px;
    border-radius: 10px;
    overflow-x: auto;
    font-size: 13px;
    line-height: 1.5;
    margin: 12px 0;
  }
  pre code {
    background: none;
    color: inherit;
    padding: 0;
  }
  hr {
    border: none;
    border-top: 2px dashed #ce93d8;
    margin: 30px 0;
  }
  strong { color: #6a1b9a; }
  em { color: #7b1fa2; }
  blockquote {
    border-left: 4px solid #ce93d8;
    background: #faf5ff;
    padding: 12px 16px;
    margin: 12px 0;
    border-radius: 0 8px 8px 0;
  }
  @media print {
    body { background: #fff; padding: 0; font-size: 11px; }
    .container { box-shadow: none; padding: 10px; border-radius: 0; }
    h1 { font-size: 1.5em; page-break-after: avoid; }
    h2 { font-size: 1.2em; page-break-after: avoid; }
    pre { font-size: 10px; page-break-inside: avoid; }
    table { page-break-inside: avoid; }
    hr { page-break-before: always; border: none; }
  }
</style>
</head>
<body>
<div class="container">
<h1 id="up-bus">üìñ ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏∏‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î ‚Äî ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå UP BUS</h1>
<h3 id="dart-flutter">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≠‡∏ö ‚Äî ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πâ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ Dart / Flutter ‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô</h3>
<hr />
<h1 id="1-maindart-68">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 1: <code>main.dart</code> (68 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏≠‡∏õ</h1>
<div class="codehilite"><pre><span></span><code><span class="n">‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</span> <span class="mi">1</span><span class="err">‚Äì</span><span class="mi">10</span><span class="p">:</span> <span class="kn">import</span><span class="w"> </span><span class="p">(</span><span class="n">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤</span> <span class="n">library</span> <span class="n">‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</span><span class="p">)</span>
</code></pre></div>

<ul>
<li><code>flutter/material.dart</code> ‚Üí ‡∏ä‡∏∏‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ UI ‡∏Ç‡∏≠‡∏á Flutter (‡∏õ‡∏∏‡πà‡∏°, ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°, ‡∏™‡∏µ ‡∏Ø‡∏•‡∏Ø)</li>
<li><code>firebase_core/firebase_core.dart</code> ‚Üí ‡πÉ‡∏ä‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Firebase</li>
<li><code>provider/provider.dart</code> ‚Üí ‡∏ï‡∏±‡∏ß‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ State (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•) ‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏´‡∏ô‡πâ‡∏≤</li>
<li><code>firebase_options.dart</code> ‚Üí ‡∏Ñ‡πà‡∏≤ config Firebase (Auto-generated)</li>
<li>Import ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏Ç‡∏≠‡∏á‡πÅ‡∏≠‡∏õ: <code>busstop-page</code>, <code>feedback-page</code>, <code>route-page</code>, <code>upbus-page</code>, <code>plan-page</code>, <code>busstop_map_page</code>, <code>login_page</code></li>
<li>Import <code>global_location_service.dart</code> ‚Üí Service ‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° GPS</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 22: void main() async {
</code></pre></div>

<ul>
<li><strong>‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô <code>main()</code></strong> = ‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà Dart ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏£‡∏Å</li>
<li><code>async</code> = ‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏á‡∏≤‡∏ô "‡∏£‡∏≠" (‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏≠ Firebase ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à)</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="nt">‡∏ö‡∏£‡∏£‡∏ó</span><span class="err">‡∏±</span><span class="nt">‡∏î</span><span class="w"> </span><span class="nt">23</span><span class="o">:</span><span class="w"> </span><span class="nt">WidgetsFlutterBinding</span><span class="p">.</span><span class="nc">ensureInitialized</span><span class="o">();</span>
</code></pre></div>

<ul>
<li>‡∏ö‡∏≠‡∏Å Flutter ‡∏ß‡πà‡∏≤ "‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏ö‡∏ö Widget ‡πÉ‡∏´‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞" ‚Äî ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ <code>await</code> ‡∏Å‡πà‡∏≠‡∏ô <code>runApp()</code></li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="nt">‡∏ö‡∏£‡∏£‡∏ó</span><span class="err">‡∏±</span><span class="nt">‡∏î</span><span class="w"> </span><span class="nt">24</span><span class="o">:</span><span class="w"> </span><span class="nt">await</span><span class="w"> </span><span class="nt">Firebase</span><span class="p">.</span><span class="nc">initializeApp</span><span class="o">(</span><span class="nt">options</span><span class="o">:</span><span class="w"> </span><span class="nt">DefaultFirebaseOptions</span><span class="p">.</span><span class="nc">currentPlatform</span><span class="o">);</span>
</code></pre></div>

<ul>
<li>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Firebase ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ config ‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏° (Android/iOS)</li>
<li><code>await</code> = ‡∏£‡∏≠‡∏à‡∏ô Firebase ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏ï‡πà‡∏≠</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="nt">‡∏ö‡∏£‡∏£‡∏ó</span><span class="err">‡∏±</span><span class="nt">‡∏î</span><span class="w"> </span><span class="nt">27</span><span class="o">:</span><span class="w"> </span><span class="nt">final</span><span class="w"> </span><span class="nt">globalLocationService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">GlobalLocationService</span><span class="o">();</span>
</code></pre></div>

<ul>
<li>‡∏™‡∏£‡πâ‡∏≤‡∏á instance ‡∏Ç‡∏≠‡∏á <code>GlobalLocationService</code> (‡∏ï‡∏±‡∏ß‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ GPS + ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô)</li>
<li>‡πÑ‡∏°‡πà <code>await initialize()</code> ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏à‡∏≠‡∏Ç‡∏≤‡∏ß‡∏Ñ‡πâ‡∏≤‡∏á‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 31‚Äì36: runApp(ChangeNotifierProvider.value(...))
</code></pre></div>

<ul>
<li><code>ChangeNotifierProvider.value()</code> = ‡∏´‡πà‡∏≠‡πÅ‡∏≠‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏î‡πâ‡∏ß‡∏¢ Provider</li>
<li>‡∏ó‡∏≥‡πÉ‡∏´‡πâ <strong>‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤</strong> ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á <code>globalLocationService</code> ‡πÑ‡∏î‡πâ</li>
<li><code>runApp(MyApp())</code> = ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏≠‡∏õ Flutter ‡∏à‡∏£‡∏¥‡∏á‡πÜ</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="err">‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</span><span class="w"> </span><span class="mi">39</span><span class="err">‚Äì</span><span class="mi">67</span><span class="p">:</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">MyApp</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">StatelessWidget</span>
</code></pre></div>

<ul>
<li>‡∏Ñ‡∏•‡∏≤‡∏™‡πÅ‡∏≠‡∏õ‡∏´‡∏•‡∏±‡∏Å (‡πÑ‡∏°‡πà‡∏°‡∏µ State ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á ‚Üí <code>StatelessWidget</code>)</li>
<li>‡∏Å‡∏≥‡∏´‡∏ô‡∏î <code>MaterialApp</code> ‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô:</li>
<li><code>debugShowCheckedModeBanner: false</code> ‚Üí ‡∏õ‡∏¥‡∏î‡πÅ‡∏ñ‡∏ö "DEBUG" ‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô</li>
<li><code>title: 'UP BUS'</code> ‚Üí ‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏≠‡∏õ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</li>
<li><code>theme</code> ‚Üí ‡∏ò‡∏µ‡∏°‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á (<code>primaryColor: 0xFF9C27B0</code>)</li>
<li><code>initialRoute: '/'</code> ‚Üí ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ñ‡∏∑‡∏≠ <code>/</code> (UpBusHomePage)</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 52‚Äì63: routes: { ... }
</code></pre></div>

<ul>
<li>‡∏Å‡∏≥‡∏´‡∏ô‡∏î <strong>Named Routes</strong> = ‡∏Å‡∏é‡∏ß‡πà‡∏≤ URL ‡πÑ‡∏´‡∏ô‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏´‡∏ô:</li>
</ul>
<table>
<thead>
<tr>
<th>Route</th>
<th>‡∏´‡∏ô‡πâ‡∏≤</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/</code></td>
<td><code>UpBusHomePage</code> (‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà Live)</td>
</tr>
<tr>
<td><code>/busStop</code></td>
<td><code>BusStopPage</code> (‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≤‡∏¢)</td>
</tr>
<tr>
<td><code>/route</code></td>
<td><code>RoutePage</code> (‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á)</td>
</tr>
<tr>
<td><code>/plan</code></td>
<td><code>PlanPage</code> (‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô)</td>
</tr>
<tr>
<td><code>/feedback</code></td>
<td><code>FeedbackPage</code></td>
</tr>
<tr>
<td><code>/login</code></td>
<td><code>LoginPage</code></td>
</tr>
<tr>
<td><code>/busStopMap</code></td>
<td><code>BusStopMapPage</code></td>
</tr>
</tbody>
</table>
<hr />
<h1 id="2-notification_servicedart-118-notification">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 2: <code>notification_service.dart</code> (118 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Notification + ‡∏™‡∏±‡πà‡∏ô</h1>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 1‚Äì2: import
</code></pre></div>

<ul>
<li><code>flutter_local_notifications</code> ‚Üí library ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á Push Notification</li>
<li><code>vibration</code> ‚Üí library ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏ô‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 5: class NotificationService
</code></pre></div>

<ul>
<li>‡πÄ‡∏õ‡πá‡∏ô <strong>Static class</strong> (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á instance, ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô <code>NotificationService.initialize()</code>)</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 6‚Äì7: static final FlutterLocalNotificationsPlugin _notifications = ...
</code></pre></div>

<ul>
<li>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß Plugin ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á Notification (‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÉ‡∏ä‡πâ‡∏ã‡πâ‡∏≥)</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="nt">‡∏ö‡∏£‡∏£‡∏ó</span><span class="err">‡∏±</span><span class="nt">‡∏î</span><span class="w"> </span><span class="nt">9</span><span class="o">:</span><span class="w"> </span><span class="nt">static</span><span class="w"> </span><span class="nt">bool</span><span class="w"> </span><span class="nt">_initialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">false</span><span class="o">;</span>
</code></pre></div>

<ul>
<li>‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ "initialize ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á?" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏ã‡πâ‡∏≥</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 12‚Äì31: static Future&lt;void&gt; initialize()
</code></pre></div>

<ul>
<li>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Notification ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Android (‡πÉ‡∏ä‡πâ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÅ‡∏≠‡∏õ <code>@mipmap/ic_launcher</code>)</li>
<li>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Notification ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö iOS (‡∏Ç‡∏≠ permission ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô, badge, ‡πÄ‡∏™‡∏µ‡∏¢‡∏á)</li>
<li>‡πÄ‡∏£‡∏µ‡∏¢‡∏Å <code>_notifications.initialize()</code> ‚Üí ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</li>
<li><code>_initialized = true</code> ‚Üí ‡∏à‡∏≥‡πÑ‡∏ß‡πâ‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡πÅ‡∏•‡πâ‡∏ß</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 35‚Äì41: static int calculateEtaSeconds(...)  ‚≠ê ‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ETA
</code></pre></div>

<ul>
<li><strong>‡∏™‡∏π‡∏ï‡∏£‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå:</strong> ‡πÄ‡∏ß‡∏•‡∏≤ = ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á √∑ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß</li>
<li>‡∏£‡∏±‡∏ö <code>distanceMeters</code> (‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏ï‡∏£) ‡πÅ‡∏•‡∏∞ <code>speedKmh</code> (‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô 35 ‡∏Å‡∏°./‡∏ä‡∏°.)</li>
<li><strong>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 39:</strong> ‡πÅ‡∏õ‡∏•‡∏á km/h ‚Üí m/s: <code>35 √ó 1000 √∑ 3600 = 9.72 m/s</code></li>
<li><strong>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 40:</strong> ‡∏´‡∏≤‡∏£ <code>distanceMeters / speedMs</code> ‡πÅ‡∏•‡πâ‡∏ß <code>.round()</code> ‡∏õ‡∏±‡∏î‡πÄ‡∏®‡∏© ‚Üí ‡πÑ‡∏î‡πâ ETA ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 44‚Äì54: static String formatEta(int etaSeconds)
</code></pre></div>

<ul>
<li>‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢:</li>
<li>‚â§ 0 ‚Üí <code>"‡∏ñ‡∏∂‡∏á‡πÅ‡∏•‡πâ‡∏ß"</code></li>
<li>&lt; 60 ‚Üí <code>"XX ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ"</code></li>
<li>‚â• 60 ‚Üí <code>"X ‡∏ô‡∏≤‡∏ó‡∏µ Y ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ"</code> ‡∏´‡∏£‡∏∑‡∏≠ <code>"X ‡∏ô‡∏≤‡∏ó‡∏µ"</code> (‡∏ñ‡πâ‡∏≤ Y = 0)</li>
<li>‡πÉ‡∏ä‡πâ <code>~/</code> = ‡∏´‡∏≤‡∏£‡∏õ‡∏±‡∏î‡∏•‡∏á (integer division), <code>%</code> = ‡πÄ‡∏≠‡∏≤‡πÄ‡∏®‡∏©</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 57‚Äì92: static Future&lt;void&gt; showBusNearbyNotification(...)
</code></pre></div>

<ul>
<li>‡πÅ‡∏™‡∏î‡∏á Push Notification ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</li>
<li>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Android: channel <code>'bus_proximity_channel'</code>, importance ‡∏™‡∏π‡∏á, ‡∏°‡∏µ‡πÄ‡∏™‡∏µ‡∏¢‡∏á+‡∏™‡∏±‡πà‡∏ô</li>
<li>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ iOS: ‡πÅ‡∏™‡∏î‡∏á alert, badge, ‡πÄ‡∏™‡∏µ‡∏¢‡∏á</li>
<li><strong>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 86:</strong> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°: <code>"‡∏£‡∏ñ‡πÄ‡∏ö‡∏≠‡∏£‡πå X ‡∏≠‡∏¢‡∏π‡πà‡∏´‡πà‡∏≤‡∏á 500 ‡πÄ‡∏°‡∏ï‡∏£ (51 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)"</code></li>
<li><strong>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 91:</strong> ‡πÅ‡∏™‡∏î‡∏á Notification ‡∏î‡πâ‡∏ß‡∏¢ emoji üöå</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 95‚Äì100: static Future&lt;void&gt; vibrate()
</code></pre></div>

<ul>
<li>‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á <strong>‡∏°‡∏µ motor ‡∏™‡∏±‡πà‡∏ô</strong> ‡πÑ‡∏´‡∏° ‚Üí ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ ‡∏™‡∏±‡πà‡∏ô 1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏£‡∏á 128</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 103‚Äì116: static Future&lt;void&gt; alertBusNearby(...)
</code></pre></div>

<ul>
<li><strong>‡∏£‡∏ß‡∏° notification + vibrate</strong> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô</li>
<li>‡πÉ‡∏ä‡πâ <code>Future.wait([...])</code> ‚Üí ‡∏ó‡∏≥ 2 ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡∏ó‡∏µ‡∏•‡∏∞‡∏≠‡∏±‡∏ô)</li>
</ul>
<hr />
<h1 id="3-route_servicedart-71-api-cache">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 3: <code>route_service.dart</code> (71 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API + Cache</h1>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 1‚Äì3: import
</code></pre></div>

<ul>
<li><code>dart:convert</code> ‚Üí ‡πÅ‡∏õ‡∏•‡∏á JSON ‡πÄ‡∏õ‡πá‡∏ô Map/List</li>
<li><code>http</code> ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡∏ú‡πà‡∏≤‡∏ô HTTP</li>
<li><code>latlong2</code> ‚Üí ‡∏Ñ‡∏•‡∏≤‡∏™‡∏û‡∏¥‡∏Å‡∏±‡∏î LatLng</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 6‚Äì10: class RouteService
</code></pre></div>

<ul>
<li>Static class ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á <strong>‡∏ï‡∏≤‡∏°‡∏ñ‡∏ô‡∏ô‡∏à‡∏£‡∏¥‡∏á</strong> ‡∏ú‡πà‡∏≤‡∏ô OpenRouteService API</li>
<li><code>_apiKey</code> = API Key (encoded Base64)</li>
<li><code>_baseUrl</code> = URL ‡∏Ç‡∏≠‡∏á API</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="nt">‡∏ö‡∏£‡∏£‡∏ó</span><span class="err">‡∏±</span><span class="nt">‡∏î</span><span class="w"> </span><span class="nt">13</span><span class="o">:</span><span class="w"> </span><span class="nt">static</span><span class="w"> </span><span class="nt">final</span><span class="w"> </span><span class="nt">Map</span><span class="o">&lt;</span><span class="nt">String</span><span class="o">,</span><span class="w"> </span><span class="nt">_CachedDistance</span><span class="o">&gt;</span><span class="w"> </span><span class="nt">_cache</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span><span class="o">;</span>
</code></pre></div>

<ul>
<li><strong>Cache</strong> = ‡∏ï‡∏±‡∏ß‡∏à‡∏≥‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡πà‡∏≤ (Map ‡∏ó‡∏µ‡πà key = "‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á-‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á", value = ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á+‡πÄ‡∏ß‡∏•‡∏≤)</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="err">‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</span><span class="w"> </span><span class="mi">14</span><span class="p">:</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Duration</span><span class="w"> </span><span class="n">_cacheExpiry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Duration</span><span class="p">(</span><span class="n">seconds</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">);</span>
</code></pre></div>

<ul>
<li>Cache <strong>‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</strong> ‚Üí ‡∏ñ‡πâ‡∏≤‡∏ñ‡∏≤‡∏°‡∏ã‡πâ‡∏≥‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡πà‡∏≤</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 18‚Äì57: static Future&lt;double?&gt; getRoadDistance(from, to)
</code></pre></div>

<p><strong>Flow ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:</strong></p>
<ol>
<li>‡∏™‡∏£‡πâ‡∏≤‡∏á cache key ‡∏à‡∏≤‡∏Å‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á-‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 19‚Äì20)</li>
<li><strong>‡πÄ‡∏ä‡πá‡∏Ñ cache</strong> (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 23‚Äì28):</li>
<li>‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡πà‡∏≤ <strong>‡πÅ‡∏•‡∏∞</strong> ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‚Üí return ‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡πà‡∏≤‡πÄ‡∏•‡∏¢</li>
<li><strong>‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API</strong> (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 30‚Äì56):</li>
<li>‡∏™‡∏£‡πâ‡∏≤‡∏á URL: <code>$_baseUrl?start=lon,lat&amp;end=lon,lat</code></li>
<li>‡∏™‡πà‡∏á HTTP GET ‡∏û‡∏£‡πâ‡∏≠‡∏° header Authorization</li>
<li>‡∏ï‡∏±‡πâ‡∏á timeout 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (‡∏ñ‡πâ‡∏≤ API ‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 5 ‡∏ß‡∏¥ ‚Üí error)</li>
<li>‡∏ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (status 200): ‡πÅ‡∏Å‡∏∞ JSON ‡πÄ‡∏≠‡∏≤‡∏Ñ‡πà‡∏≤ distance ‚Üí <strong>‡πÄ‡∏Å‡πá‡∏ö cache</strong> ‚Üí return</li>
<li>‡∏ñ‡πâ‡∏≤‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: print error ‚Üí return <code>null</code></li>
</ol>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 60‚Äì62: static void clearCache()
</code></pre></div>

<ul>
<li>‡∏•‡πâ‡∏≤‡∏á cache ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 65‚Äì70: class _CachedDistance
</code></pre></div>

<ul>
<li>Model ‡πÄ‡∏Å‡πá‡∏ö distance + timestamp (‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà cache ‡πÑ‡∏ß‡πâ) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á</li>
</ul>
<hr />
<h1 id="4-global_location_servicedart-431-gps">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 4: <code>global_location_service.dart</code> (431 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö GPS + ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô ‚≠ê</h1>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 1‚Äì9: import
</code></pre></div>

<ul>
<li><code>dart:async</code> ‚Üí ‡πÉ‡∏ä‡πâ StreamSubscription (‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á)</li>
<li><code>geolocator</code> ‚Üí ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° GPS ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</li>
<li><code>latlong2</code> ‚Üí ‡∏Ñ‡∏•‡∏≤‡∏™‡∏û‡∏¥‡∏Å‡∏±‡∏î</li>
<li><code>firebase_database</code> ‚Üí Realtime Database (‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏£‡∏ñ)</li>
<li><code>cloud_firestore</code> ‚Üí Firestore (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏ñ)</li>
<li>Import models ‡πÅ‡∏•‡∏∞ services ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="err">‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</span><span class="w"> </span><span class="mi">13</span><span class="err">‚Äì</span><span class="mi">17</span><span class="p">:</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">GlobalLocationService</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">ChangeNotifier</span><span class="w"> </span><span class="err">‚Äî</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="n">Pattern</span>
</code></pre></div>

<ul>
<li><code>extends ChangeNotifier</code> ‚Üí ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ "‡πÅ‡∏à‡πâ‡∏á" UI ‡πÉ‡∏´‡πâ rebuild ‡πÑ‡∏î‡πâ</li>
<li><strong>Singleton Pattern:</strong></li>
<li><code>_instance</code> = instance ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÉ‡∏ä‡πâ‡∏ã‡πâ‡∏≥‡∏ó‡∏±‡πâ‡∏á‡πÅ‡∏≠‡∏õ</li>
<li><code>factory</code> constructor ‚Üí ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏µ‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏¥‡∏°</li>
<li><code>_internal()</code> = constructor ‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÅ‡∏Ñ‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 19‚Äì42: ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ State ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
</code></pre></div>

<table>
<thead>
<tr>
<th>‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£</th>
<th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>_userPosition</code></td>
<td>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á GPS ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</td>
</tr>
<tr>
<td><code>_buses</code></td>
<td>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏ñ‡∏ö‡∏±‡∏™‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà online</td>
</tr>
<tr>
<td><code>_closestBus</code></td>
<td>‡∏£‡∏ñ‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</td>
</tr>
<tr>
<td><code>_allBusStops</code></td>
<td>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏ñ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å Firestore</td>
</tr>
<tr>
<td><code>_notifyEnabled</code></td>
<td>‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà</td>
</tr>
<tr>
<td><code>_selectedNotifyRouteId</code></td>
<td>‡∏™‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (null = ‡∏ó‡∏∏‡∏Å‡∏™‡∏≤‡∏¢)</td>
</tr>
<tr>
<td><code>_destinationName</code></td>
<td>‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á</td>
</tr>
<tr>
<td><code>_prevDistToDest</code></td>
<td>Map ‡πÄ‡∏Å‡πá‡∏ö "‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏£‡∏ñ‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢" ‡∏£‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô (‡πÉ‡∏ä‡πâ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á)</td>
</tr>
<tr>
<td><code>_lastAlertStage</code></td>
<td>Map ‡πÄ‡∏Å‡πá‡∏ö "‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡πÑ‡∏´‡∏ô‡πÅ‡∏•‡πâ‡∏ß" (0=‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏à‡πâ‡∏á, 4=‡∏ñ‡∏∂‡∏á‡πÅ‡∏•‡πâ‡∏ß)</td>
</tr>
<tr>
<td><code>_alertDistanceMeters</code></td>
<td>250 ‡πÄ‡∏°‡∏ï‡∏£ = ‡∏£‡∏∞‡∏¢‡∏∞ "‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡πÅ‡∏•‡πâ‡∏ß"</td>
</tr>
</tbody>
</table>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 56‚Äì68: Future&lt;void&gt; initialize()
</code></pre></div>

<ol>
<li>‡∏ñ‡πâ‡∏≤ <code>_isInitialized</code> ‡πÅ‡∏•‡πâ‡∏ß ‚Üí return (‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏ã‡πâ‡∏≥)</li>
<li>‡πÄ‡∏£‡∏µ‡∏¢‡∏Å <code>NotificationService.initialize()</code> ‚Üí ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</li>
<li>‡πÄ‡∏£‡∏µ‡∏¢‡∏Å <code>_fetchBusStops()</code> ‚Üí ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡πâ‡∏≤‡∏¢‡∏à‡∏≤‡∏Å Firestore</li>
<li>‡πÄ‡∏£‡∏µ‡∏¢‡∏Å <code>_listenToBusLocation()</code> ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î listener ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏£‡∏ñ‡∏à‡∏≤‡∏Å RTDB</li>
<li>‡πÄ‡∏£‡∏µ‡∏¢‡∏Å <code>_startLocationTracking()</code> ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î GPS ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</li>
</ol>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 71‚Äì79: void setNotifyEnabled(bool, routeId)
</code></pre></div>

<ul>
<li>‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô + ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏¢</li>
<li><code>_lastAlertStage.clear()</code> ‚Üí reset ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà)</li>
<li><code>notifyListeners()</code> ‚Üí ‡∏ö‡∏≠‡∏Å UI ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 82‚Äì103: void setDestination(name, routeId)
</code></pre></div>

<ul>
<li>‡∏ï‡∏±‡πâ‡∏á‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á</li>
<li>‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢ ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î notify ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ + ‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏≤‡∏¢</li>
<li>‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô null ‚Üí ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢</li>
<li>‡πÄ‡∏£‡∏µ‡∏¢‡∏Å <code>_updateClosestBus()</code> ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‚Üí ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏•‡∏¢</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 106‚Äì116: LatLng? get destinationPosition
</code></pre></div>

<ul>
<li>‡∏´‡∏≤‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≤‡∏¢ (‡∏Ñ‡πâ‡∏ô‡∏à‡∏≤‡∏Å <code>_allBusStops</code>)</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 119‚Äì142: Future&lt;void&gt; _fetchBusStops()
</code></pre></div>

<ul>
<li>‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏ñ‡∏à‡∏≤‡∏Å Firestore collection <code>'Bus stop'</code></li>
<li>‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏∏‡∏Å document ‡πÄ‡∏õ‡πá‡∏ô Map ‡∏ó‡∏µ‡πà‡∏°‡∏µ: id, name, lat, long, route_id</li>
<li>‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô <code>_allBusStops</code></li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 145‚Äì177: void _listenToBusLocation()
</code></pre></div>

<ul>
<li>‡∏ü‡∏±‡∏á Realtime Database path <code>"GPS"</code> ‡πÅ‡∏ö‡∏ö real-time</li>
<li>‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‚Üí ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô List ‡∏Ç‡∏≠‡∏á <code>Bus</code> object</li>
<li>‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏ñ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ <code>lat</code> ‡πÅ‡∏•‡∏∞ <code>lng</code></li>
<li>‡πÄ‡∏£‡∏µ‡∏¢‡∏Å <code>_updateClosestBus()</code> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏ñ‡πÉ‡∏Å‡∏•‡πâ‡∏™‡∏∏‡∏î‡πÉ‡∏´‡∏°‡πà</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 180‚Äì219: Future&lt;void&gt; _startLocationTracking()
</code></pre></div>

<ol>
<li>‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ GPS ‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏´‡∏° ‚Üí ‡∏ñ‡πâ‡∏≤‡∏õ‡∏¥‡∏î return</li>
<li>‡πÄ‡∏ä‡πá‡∏Ñ permission ‚Üí ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏´‡πâ ‡∏Ç‡∏≠ permission</li>
<li>‡πÄ‡∏õ‡∏¥‡∏î <code>Geolocator.getPositionStream()</code> ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏™‡∏π‡∏á + ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å ‚â•10 ‡πÄ‡∏°‡∏ï‡∏£</li>
<li>‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏´‡∏°‡πà ‚Üí ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï <code>_userPosition</code> ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å <code>_updateClosestBus()</code></li>
</ol>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 222‚Äì364: Future&lt;void&gt; _updateClosestBus()  ‚≠ê ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å (‡∏¢‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)
</code></pre></div>

<p><strong>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1 (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 222‚Äì246): ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á</strong>
- ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏ó‡∏∏‡∏Å‡∏£‡∏ñ:
  - ‡∏•‡∏≠‡∏á API ‡∏Å‡πà‡∏≠‡∏ô (<code>RouteService.getRoadDistance</code>) ‚Üí ‡πÑ‡∏î‡πâ‡∏£‡∏∞‡∏¢‡∏∞‡∏ñ‡∏ô‡∏ô‡∏à‡∏£‡∏¥‡∏á
  - ‡∏ñ‡πâ‡∏≤ API fail ‚Üí ‡πÉ‡∏ä‡πâ Haversine ‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á‡πÅ‡∏ó‡∏ô
  - ‡∏™‡∏£‡πâ‡∏≤‡∏á Bus object ‡πÉ‡∏´‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡πà‡∏≤ distance
- ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏£‡∏ñ‡∏à‡∏≤‡∏Å‡πÉ‡∏Å‡∏•‡πâ ‚Üí ‡πÑ‡∏Å‡∏•
- ‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏ñ‡πÉ‡∏Å‡∏•‡πâ‡∏™‡∏∏‡∏î‡πÑ‡∏ß‡πâ‡πÉ‡∏ô <code>_closestBus</code></p>
<p><strong>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2 (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 249‚Äì319): ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å target bus ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</strong>
- <strong>‡∏Å‡∏£‡∏ì‡∏µ A (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 253‚Äì309):</strong> ‡∏°‡∏µ‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢ ‚Üí ‡∏Å‡∏£‡∏≠‡∏á‡∏™‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á ‚Üí <strong>‡πÄ‡∏ä‡πá‡∏Ñ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á</strong> (‡∏£‡∏ñ‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡∏¥‡πà‡∏á‡∏´‡∏ô‡∏µ) ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏£‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
- <strong>‡∏Å‡∏£‡∏ì‡∏µ B (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 310‚Äì315):</strong> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏¢‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢ ‚Üí ‡πÄ‡∏≠‡∏≤‡∏Ñ‡∏±‡∏ô‡πÉ‡∏Å‡∏•‡πâ‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏¢‡∏ô‡∏±‡πâ‡∏ô
- <strong>‡∏Å‡∏£‡∏ì‡∏µ C (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 316‚Äì319):</strong> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏∏‡∏Å‡∏™‡∏≤‡∏¢ ‚Üí ‡πÄ‡∏≠‡∏≤‡∏Ñ‡∏±‡∏ô‡πÉ‡∏Å‡∏•‡πâ‡∏™‡∏∏‡∏î‡πÄ‡∏•‡∏¢</p>
<p><strong>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3 (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 321‚Äì360): ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô 4 ‡∏Ç‡∏±‡πâ‡∏ô</strong>
- ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ETA ‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á
- ‡πÄ‡∏ä‡πá‡∏Ñ‡πÅ‡∏ï‡πà‡∏•‡∏∞ Stage ‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡∏±‡∏Å‡πÑ‡∏õ‡πÄ‡∏ö‡∏≤:</p>
<table>
<thead>
<tr>
<th>Stage</th>
<th>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</th>
<th>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</th>
</tr>
</thead>
<tbody>
<tr>
<td>4 (‡∏ñ‡∏∂‡∏á‡πÅ‡∏•‡πâ‡∏ß)</td>
<td>‚â§ 250 ‡πÄ‡∏°‡∏ï‡∏£</td>
<td>328‚Äì337</td>
</tr>
<tr>
<td>3 (1 ‡∏ô‡∏≤‡∏ó‡∏µ)</td>
<td>ETA ‚â§ 60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</td>
<td>340‚Äì344</td>
</tr>
<tr>
<td>2 (3 ‡∏ô‡∏≤‡∏ó‡∏µ)</td>
<td>ETA ‚â§ 180 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</td>
<td>347‚Äì351</td>
</tr>
<tr>
<td>1 (5 ‡∏ô‡∏≤‡∏ó‡∏µ)</td>
<td>ETA ‚â§ 300 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</td>
<td>354‚Äì358</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πâ‡∏≥:</strong> ‡πÉ‡∏ä‡πâ <code>_lastAlertStage[busId]</code> ‡∏à‡∏≥‡∏ß‡πà‡∏≤‡∏Ñ‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏ñ‡∏∂‡∏á Stage ‡πÑ‡∏´‡∏ô‡πÅ‡∏•‡πâ‡∏ß</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 366‚Äì380: Future&lt;void&gt; _triggerAlert(...)
</code></pre></div>

<ul>
<li>‡πÄ‡∏£‡∏µ‡∏¢‡∏Å <code>NotificationService.alertBusNearby()</code> (notification + ‡∏™‡∏±‡πà‡∏ô)</li>
<li>print log ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö debug</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 383‚Äì422: getClosestStopInfo() + findClosestStop()
</code></pre></div>

<ul>
<li>‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏ó‡∏∏‡∏Å‡∏õ‡πâ‡∏≤‡∏¢ ‚Üí ‡∏´‡∏≤‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ <code>_userPosition</code> ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</li>
<li>‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°: <code>"‡∏ä‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≤‡∏¢ (XXXm)"</code></li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 425‚Äì430: dispose()
</code></pre></div>

<ul>
<li>‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å subscription ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô memory leak)</li>
</ul>
<hr />
<h1 id="5-bus_modeldart-111-model">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 5: <code>bus_model.dart</code> (111 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî Model ‡∏£‡∏ñ‡∏ö‡∏±‡∏™ + ‡∏™‡∏≤‡∏¢‡∏£‡∏ñ</h1>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 3‚Äì63: class Bus
</code></pre></div>

<ul>
<li>Model ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ñ‡∏ö‡∏±‡∏™ 1 ‡∏Ñ‡∏±‡∏ô</li>
<li>Fields: <code>id</code>, <code>position (LatLng)</code>, <code>name</code>, <code>routeId</code>, <code>distanceToUser</code>, <code>driverName</code>, <code>routeColor</code></li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 24‚Äì49: factory Bus.fromFirebase(id, data)  ‚Äî ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å RTDB
</code></pre></div>

<ul>
<li><strong>Nested Fix (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 26‚Äì33):</strong> ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡πÑ‡∏´‡∏° (‡πÄ‡∏ä‡πà‡∏ô <code>bus_1.bus_1.driverName</code>)</li>
<li>‡∏ñ‡πâ‡∏≤‡πÄ‡∏à‡∏≠ key ‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô id ‡∏ã‡πâ‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà ‚Üí ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ô‡πÅ‡∏ó‡∏ô</li>
<li>‡∏û‡∏¥‡∏Å‡∏±‡∏î GPS ‡πÉ‡∏ä‡πâ <code>data['lat']</code>, <code>data['lng']</code> (‡∏ä‡∏±‡πâ‡∏ô‡∏ô‡∏≠‡∏Å)</li>
<li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö‡πÉ‡∏ä‡πâ <code>driverData</code> (‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ô)</li>
<li>‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏ñ: <code>"‡∏£‡∏ñ‡πÄ‡∏ö‡∏≠‡∏£‡πå ${id.split('_').last}"</code> ‚Üí <code>bus_1</code> ‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô <code>"‡∏£‡∏ñ‡πÄ‡∏ö‡∏≠‡∏£‡πå 1"</code></li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 52‚Äì62: Bus copyWithDistance(dist)
</code></pre></div>

<ul>
<li>‡∏™‡∏£‡πâ‡∏≤‡∏á Bus ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà copy ‡∏ó‡∏∏‡∏Å‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏ï‡πà‡πÉ‡∏™‡πà <code>distanceToUser</code> ‡πÉ‡∏´‡∏°‡πà (Immutable Pattern)</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 66‚Äì110: class BusRoute ‚Äî Model ‡∏™‡∏≤‡∏¢‡∏£‡∏ñ
</code></pre></div>

<ul>
<li>Fields: <code>id</code>, <code>name</code>, <code>shortName</code>, <code>colorValue</code></li>
<li><code>allRoutes</code> = 3 ‡∏™‡∏≤‡∏¢: Green (‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≠), Red (‡∏´‡∏≠‡∏û‡∏±‡∏Å), Blue (‡∏õ‡∏£‡∏∞‡∏ï‡∏π‡∏á‡∏≤‡∏°)</li>
<li><code>fromId(id)</code> = ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏≤‡∏¢‡∏à‡∏≤‡∏Å ID (case insensitive)</li>
</ul>
<hr />
<h1 id="6-bus_route_datadart-297-hard-coded">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 6: <code>bus_route_data.dart</code> (297 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡πâ‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á (Hard-coded)</h1>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 2‚Äì20: class BusStopData ‚Äî Model ‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏ñ
</code></pre></div>

<ul>
<li>Fields: <code>id</code>, <code>name</code>, <code>shortName</code></li>
<li>Override <code>==</code> ‚Üí ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏õ‡πâ‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ <code>id</code> (‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏≤ intersection)</li>
<li>Override <code>hashCode</code> ‚Üí ‡πÉ‡∏ä‡πâ <code>id.hashCode</code></li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 23‚Äì78: class BusRouteData ‚Äî Model ‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏õ‡πâ‡∏≤‡∏¢
</code></pre></div>

<ul>
<li>Fields: <code>routeId</code>, <code>name</code>, <code>shortName</code>, <code>colorValue</code>, <code>stops</code> (List ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏õ‡πâ‡∏≤‡∏¢), <code>startHour</code>, <code>endHour</code></li>
<li><strong><code>isActiveAt(DateTime)</code> (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 43‚Äì55):</strong> ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏™‡∏≤‡∏¢‡∏ô‡∏µ‡πâ‡∏ß‡∏¥‡πà‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡πà‡∏≤</li>
<li>‡∏ñ‡πâ‡∏≤ startHour/endHour ‡πÄ‡∏õ‡πá‡∏ô null ‚Üí ‡∏ß‡∏¥‡πà‡∏á‡∏ï‡∏•‡∏≠‡∏î‡∏ß‡∏±‡∏ô (return true)</li>
<li>‡∏ñ‡πâ‡∏≤ startHour ‚â§ endHour ‚Üí ‡πÄ‡∏ä‡πá‡∏Ñ‡∏õ‡∏Å‡∏ï‡∏¥ (‡πÄ‡∏ä‡πà‡∏ô 5 ‚â§ ‡∏ä‡∏°. &lt; 14)</li>
<li>‡∏ñ‡πâ‡∏≤ startHour &gt; endHour ‚Üí <strong>‡∏Ç‡πâ‡∏≤‡∏°‡∏ß‡∏±‡∏ô</strong> (‡πÄ‡∏ä‡πà‡∏ô 14:00‚Äì00:00 ‚Üí ‡∏ä‡∏°. ‚â• 14 <strong>‡∏´‡∏£‡∏∑‡∏≠</strong> ‡∏ä‡∏°. &lt; 0)</li>
<li><code>indexOfStop(id)</code>, <code>lastIndexOfStop(id)</code>, <code>allIndicesOfStop(id)</code> ‚Üí ‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡πÉ‡∏ô‡∏•‡∏≥‡∏î‡∏±‡∏ö</li>
<li><code>hasStop(id)</code> ‚Üí ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏õ‡πâ‡∏≤‡∏¢‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏™‡∏≤‡∏¢‡πÑ‡∏´‡∏°</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 81‚Äì195: class BusStops ‚Äî ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Static)
</code></pre></div>

<ul>
<li>‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á 14 ‡∏õ‡πâ‡∏≤‡∏¢: namor, engineering, auditorium, president, arts, science, pky, ub99, wiangphayao, sanguansermsri, satit, gate3, economyCenter, ict</li>
<li><code>fromId(id)</code> ‚Üí ‡∏´‡∏≤‡∏õ‡πâ‡∏≤‡∏¢‡∏à‡∏≤‡∏Å id</li>
<li><code>fromName(name)</code> ‚Üí ‡∏´‡∏≤‡∏õ‡πâ‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠ (fuzzy match ‚Äî ‡∏Ñ‡πâ‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡∏∞ shortName)</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 198‚Äì296: class BusRoutes ‚Äî ‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Static)
</code></pre></div>

<ul>
<li><strong>S1-AM</strong> (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 200‚Äì217): ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß, 05:00‚Äì14:00, ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô PKY</li>
<li>‡∏•‡∏≥‡∏î‡∏±‡∏ö: ‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≠ ‚Üí ‡∏ß‡∏¥‡∏®‡∏ß‡∏∞ ‚Üí ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‚Üí ‡∏≠‡∏ò‡∏¥‡∏Å‡∏≤‡∏£ ‚Üí ‡∏®‡∏¥‡∏•‡∏õ‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‚Üí ‡∏ß‡∏¥‡∏ó‡∏¢‡πå ‚Üí ‡∏ß‡∏¥‡∏®‡∏ß‡∏∞ ‚Üí ‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≠</li>
<li><strong>S1-PM</strong> (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 220‚Äì238): ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß, 14:00‚Äì00:00, <strong>‡∏ú‡πà‡∏≤‡∏ô PKY</strong></li>
<li>‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÅ‡∏ï‡πà‡πÄ‡∏û‡∏¥‡πà‡∏° PKY ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏ò‡∏¥‡∏Å‡∏≤‡∏£</li>
<li><strong>S2</strong> (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 241‚Äì261): ‡πÅ‡∏î‡∏á, ‡∏ß‡∏¥‡πà‡∏á‡∏ï‡∏•‡∏≠‡∏î‡∏ß‡∏±‡∏ô</li>
<li>‡∏•‡∏≥‡∏î‡∏±‡∏ö: PKY ‚Üí UB99 ‚Üí ‡πÄ‡∏ß‡∏µ‡∏¢‡∏á ‚Üí ‡∏™‡∏á‡∏ß‡∏ô ‚Üí ‡∏™‡∏≤‡∏ò‡∏¥‡∏ï ‚Üí ‡∏™‡∏á‡∏ß‡∏ô ‚Üí ‡πÄ‡∏ß‡∏µ‡∏¢‡∏á ‚Üí UB99 ‚Üí ‡∏®‡∏¥‡∏•‡∏õ‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‚Üí ‡∏ß‡∏¥‡∏ó‡∏¢‡πå ‚Üí ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‚Üí ‡∏≠‡∏ò‡∏¥‡∏Å‡∏≤‡∏£ ‚Üí PKY</li>
<li><strong>S3</strong> (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 264‚Äì280): ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô, ‡∏ß‡∏¥‡πà‡∏á‡∏ï‡∏•‡∏≠‡∏î‡∏ß‡∏±‡∏ô</li>
<li>
<p>‡∏•‡∏≥‡∏î‡∏±‡∏ö: ‡∏õ‡∏£‡∏∞‡∏ï‡∏π3 ‚Üí ‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à ‚Üí ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‚Üí ‡∏≠‡∏ò‡∏¥‡∏Å‡∏≤‡∏£ ‚Üí ‡∏®‡∏¥‡∏•‡∏õ‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‚Üí ‡∏ß‡∏¥‡∏ó‡∏¢‡πå ‚Üí ‡∏ß‡∏¥‡∏®‡∏ß‡∏∞ ‚Üí ICT ‚Üí ‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à ‚Üí ‡∏õ‡∏£‡∏∞‡∏ï‡∏π3</p>
</li>
<li>
<p><code>getActiveRoutes(time)</code> ‚Üí ‡∏´‡∏≤‡∏™‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡πà‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</p>
</li>
<li><code>getRoutesWithStop(stopId)</code> ‚Üí ‡∏´‡∏≤‡∏™‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡πâ‡∏≤‡∏¢‡∏ô‡∏µ‡πâ</li>
</ul>
<hr />
<h1 id="7-route_planner_servicedart-641">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 7: <code>route_planner_service.dart</code> (641 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á ‚≠ê</h1>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 5‚Äì27: class RouteResult ‚Äî ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á
</code></pre></div>

<ul>
<li><code>found</code> ‚Üí ‡∏û‡∏ö‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà</li>
<li><code>segments</code> ‚Üí List ‡∏Ç‡∏≠‡∏á‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á (RouteSegment)</li>
<li><code>message</code> ‚Üí ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ (‡πÄ‡∏ä‡πà‡∏ô "‡∏Ç‡∏∂‡πâ‡∏ô S1 ‡πÑ‡∏õ‡∏•‡∏á PKY")</li>
<li><code>timeNote</code> ‚Üí ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏ß‡∏•‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô "S1 ‡∏ß‡∏¥‡πà‡∏á‡∏´‡∏•‡∏±‡∏á 14:00")</li>
<li><code>transferCount</code> ‚Üí ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≠‡∏£‡∏ñ</li>
<li><code>isDirect</code> ‚Üí ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ï‡∏£‡∏á (1 segment) ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 30‚Äì47: class RouteSegment ‚Äî ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á 1 ‡∏™‡∏≤‡∏¢
</code></pre></div>

<ul>
<li>‡πÄ‡∏Å‡πá‡∏ö: ‡∏™‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ, ‡∏õ‡πâ‡∏≤‡∏¢‡∏ï‡πâ‡∏ô, ‡∏õ‡πâ‡∏≤‡∏¢‡∏õ‡∏•‡∏≤‡∏¢, ‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≤‡∏á, ‡πÄ‡∏õ‡πá‡∏ô loop ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà</li>
<li><code>stopCount</code> = ‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≤‡∏á + 1</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 52‚Äì66: findRoute() ‚Äî ‡∏´‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
</code></pre></div>

<ul>
<li>‡πÄ‡∏£‡∏µ‡∏¢‡∏Å <code>findAllRoutes()</code> ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏≠‡∏≤‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÅ‡∏£‡∏Å (‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 69‚Äì178: findAllRoutes()  ‚≠ê ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å
</code></pre></div>

<p><strong>Flow:</strong>
1. ‡∏´‡∏≤‡∏™‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡πà‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ (<code>getActiveRoutes</code>)
2. ‡∏´‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á <strong>‡∏ï‡∏£‡∏á</strong> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å‡∏™‡∏≤‡∏¢ active
3. ‡∏´‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á <strong>‡∏ï‡πà‡∏≠‡∏£‡∏ñ</strong> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å‡∏™‡∏≤‡∏¢ active
4. ‡∏´‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏à‡∏≤‡∏Å <strong>‡∏ó‡∏∏‡∏Å‡∏™‡∏≤‡∏¢</strong> (‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ß‡∏¥‡πà‡∏á) + ‡πÉ‡∏™‡πà timeNote
5. ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏° <strong>Weighted Score</strong> (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡πâ‡∏≠‡∏¢ = ‡∏î‡∏µ)
6. ‡∏•‡∏ö‡∏ú‡∏•‡∏ã‡πâ‡∏≥ (dedup ‡∏î‡πâ‡∏ß‡∏¢ key = ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
7. ‡∏Ñ‡∏∑‡∏ô <strong>3 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡πÅ‡∏£‡∏Å</strong></p>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 182‚Äì198: _calculateWeightedScore()  ‚≠ê ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
</code></pre></div>

<ul>
<li><strong>‡∏™‡∏π‡∏ï‡∏£:</strong> ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô = ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡πâ‡∏≤‡∏¢ + penalty</li>
<li>Penalty ‡∏ß‡∏ô‡∏£‡∏ñ (loop): <strong>+20</strong> ‡∏ï‡πà‡∏≠ segment ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ß‡∏ô</li>
<li>Penalty ‡∏ï‡πà‡∏≠‡∏£‡∏ñ (transfer): <strong>+5</strong> ‡∏ï‡πà‡∏≠‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏≤‡∏¢</li>
<li><strong>‡∏¢‡∏¥‡πà‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ</strong></li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 260‚Äì263: _isCircular() ‚Äî ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á‡∏Å‡∏•‡∏°‡πÑ‡∏´‡∏°
</code></pre></div>

<ul>
<li>‡∏î‡∏π‡∏á‡πà‡∏≤‡∏¢‡πÜ: ‡∏õ‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏Å == ‡∏õ‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢ ‚Üí ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á‡∏Å‡∏•‡∏°</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 266‚Äì278: _calculateStopCount() ‚Äî ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡πâ‡∏≤‡∏¢
</code></pre></div>

<ul>
<li>‡∏Å‡∏£‡∏ì‡∏µ‡∏õ‡∏Å‡∏ï‡∏¥ (fromIdx &lt; toIdx): <code>toIdx - fromIdx</code></li>
<li>‡∏Å‡∏£‡∏ì‡∏µ‡∏ß‡∏ô‡∏•‡∏π‡∏õ (fromIdx &gt; toIdx, circular): <code>(total - 1 - fromIdx) + toIdx</code></li>
<li>‡∏Å‡∏£‡∏ì‡∏µ‡∏≠‡∏∑‡πà‡∏ô: return 999 (‡πÑ‡∏õ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 281‚Äì301: _getStopsInBetween() ‚Äî ‡∏î‡∏∂‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≤‡∏á
</code></pre></div>

<ul>
<li>‡∏Å‡∏£‡∏ì‡∏µ‡∏õ‡∏Å‡∏ï‡∏¥: ‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á fromIdx+1 ‡∏ñ‡∏∂‡∏á toIdx-1</li>
<li>‡∏Å‡∏£‡∏ì‡∏µ‡∏ß‡∏ô‡∏•‡∏π‡∏õ: ‡πÄ‡∏Å‡πá‡∏ö‡∏à‡∏≤‡∏Å fromIdx+1 ‚Üí ‡∏™‡∏∏‡∏î‡∏™‡∏≤‡∏¢ ‚Üí ‡∏ß‡∏ô‡∏Å‡∏•‡∏±‡∏ö 1 ‚Üí toIdx-1</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 323‚Äì367: _splitIfPassingTerminal() ‚Äî ‡πÅ‡∏ö‡πà‡∏á segment ‡∏ñ‡πâ‡∏≤‡∏ú‡πà‡∏≤‡∏ô PKY/‡∏õ‡∏£‡∏∞‡∏ï‡∏π3
</code></pre></div>

<ul>
<li>‡∏ñ‡πâ‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á <strong>‡∏ú‡πà‡∏≤‡∏ô terminal</strong> (PKY ‡∏´‡∏£‡∏∑‡∏≠ ‡∏õ‡∏£‡∏∞‡∏ï‡∏π3) ‚Üí ‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏™‡πà‡∏ß‡∏ô</li>
<li>‡∏ó‡∏≥‡πÉ‡∏´‡πâ UI ‡πÅ‡∏™‡∏î‡∏á "‡∏•‡∏á‡∏ó‡∏µ‡πà PKY ‚Üí ‡∏ï‡πà‡∏≠ S1 ‡πÑ‡∏õ xxx" ‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 369‚Äì421: _findAllDirectRoutes() ‚Äî ‡∏´‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ï‡∏£‡∏á
</code></pre></div>

<ul>
<li>‡∏ß‡∏ô‡∏ó‡∏∏‡∏Å‡∏™‡∏≤‡∏¢ ‚Üí ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á fromStop ‡πÅ‡∏•‡∏∞ toStop ‡πÑ‡∏´‡∏°</li>
<li>‡∏•‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏π‡πà indices (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏≤‡∏¢‡∏à‡∏∏‡∏î‡πÉ‡∏ô‡∏™‡∏≤‡∏¢ loop)</li>
<li>‡∏™‡∏£‡πâ‡∏≤‡∏á RouteResult ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 425‚Äì571: _findAllTransferRoutes() ‚Äî ‡∏´‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ï‡πà‡∏≠‡∏£‡∏ñ
</code></pre></div>

<ul>
<li>‡∏´‡∏≤‡∏™‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á + ‡∏´‡∏≤‡∏™‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á</li>
<li>‡∏ß‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏π‡πà‡∏™‡∏≤‡∏¢ ‚Üí ‡∏´‡∏≤‡∏à‡∏∏‡∏î‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏≤‡∏¢</li>
<li><strong>‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ï‡πà‡∏≠‡∏£‡∏ñ‡∏™‡∏≤‡∏¢‡πÄ‡∏î‡∏¥‡∏°</strong> ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏ó‡∏µ‡πà terminal (PKY, ‡∏õ‡∏£‡∏∞‡∏ï‡∏π3, ‡∏ß‡∏¥‡∏®‡∏ß‡∏∞)</li>
<li>‡∏•‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏π‡πà indices ‚Üí ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì stopCount ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å best</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 574‚Äì581: _findTransferPoints() ‚Äî ‡∏´‡∏≤‡∏à‡∏∏‡∏î‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏≤‡∏¢ (Set Intersection)
</code></pre></div>

<ul>
<li>‡πÄ‡∏≠‡∏≤‡∏õ‡πâ‡∏≤‡∏¢‡∏™‡∏≤‡∏¢ 1 ‚Üí Set, ‡∏õ‡πâ‡∏≤‡∏¢‡∏™‡∏≤‡∏¢ 2 ‚Üí Set ‚Üí ‡∏´‡∏≤ <code>.intersection()</code></li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 584‚Äì639: mapFirebaseIdToStopId() ‚Äî ‡πÅ‡∏õ‡∏•‡∏á Firebase ID ‡πÄ‡∏õ‡πá‡∏ô internal ID
</code></pre></div>

<ul>
<li>‡∏•‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô (<code>BusStops.fromName</code>)</li>
<li>‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠ ‚Üí ‡πÉ‡∏ä‡πâ keyword matching (‡πÄ‡∏ä‡πà‡∏ô "‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≠" ‚Üí <code>namor</code>, "‡∏ß‡∏¥‡∏®‡∏ß" ‚Üí <code>engineering</code>)</li>
</ul>
<hr />
<h1 id="8-login_pagedart-273">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 8: <code>login_page.dart</code> (273 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</h1>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 11‚Äì15: ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ State
</code></pre></div>

<ul>
<li><code>_emailController</code>, <code>_passwordController</code> ‚Üí ‡∏à‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏û‡∏¥‡∏°‡∏û‡πå</li>
<li><code>_isLoading</code> ‚Üí ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏´‡∏° (‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏´‡∏°‡∏∏‡∏ô)</li>
<li><code>_obscurePassword</code> ‚Üí ‡∏ã‡πà‡∏≠‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (‚óè‚óè‚óè) ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏™‡∏î‡∏á</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 18‚Äì21: Email lists
</code></pre></div>

<ul>
<li><code>driverEmails</code> = email ‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö (‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏•‡∏±‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô)</li>
<li><code>managerEmails</code> = email ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 23‚Äì69: _handleLogin()
</code></pre></div>

<ol>
<li>‡πÄ‡∏£‡∏µ‡∏¢‡∏Å <code>FirebaseAuth.signInWithEmailAndPassword()</code> ‚Üí ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</li>
<li>‡πÄ‡∏ä‡πá‡∏Ñ email:</li>
<li>‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô <code>managerEmails</code> ‚Üí ‡πÑ‡∏õ <code>ManagerPage</code></li>
<li>‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô <code>driverEmails</code> ‚Üí ‡πÑ‡∏õ <code>ChangeRoutePage</code></li>
<li>‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‚Üí <code>Navigator.pop()</code> ‡∏Å‡∏•‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà (‡∏ú‡∏π‡πâ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£)</li>
<li>‡∏ñ‡πâ‡∏≤ error ‚Üí ‡πÅ‡∏™‡∏î‡∏á SnackBar</li>
</ol>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 73‚Äì271: build() ‚Äî ‡∏™‡∏£‡πâ‡∏≤‡∏á UI
</code></pre></div>

<ul>
<li>‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á: Gradient ‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á ‚Üí ‡∏°‡πà‡∏ß‡∏á‡∏≠‡πà‡∏≠‡∏ô ‚Üí ‡∏ä‡∏°‡∏û‡∏π</li>
<li>‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏£‡∏ñ‡∏ö‡∏±‡∏™‡∏ß‡∏á‡∏Å‡∏•‡∏° + ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "UP BUS"</li>
<li>‡∏ä‡πà‡∏≠‡∏á email + password (‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô)</li>
<li>‡∏õ‡∏∏‡πà‡∏° "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö" Gradient ‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á ‡∏û‡∏£‡πâ‡∏≠‡∏° shadow</li>
</ul>
<hr />
<h1 id="9-sidemenudart-186">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 9: <code>sidemenu.dart</code> (186 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡πâ‡∏≤‡∏á</h1>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 15‚Äì23: ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£
</code></pre></div>

<ul>
<li><code>driverEmails</code> = ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ email ‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö</li>
<li><code>managerEmails</code> = ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ email ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 26‚Äì183: build() ‚Äî ‡∏™‡∏£‡πâ‡∏≤‡∏á Drawer
</code></pre></div>

<ul>
<li>‡πÄ‡∏ä‡πá‡∏Ñ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <code>FirebaseAuth.instance.currentUser</code></li>
<li>Header: ‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå + email + badge "‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£" (‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πà)</li>
<li><strong>‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏ô‡∏π‡∏ï‡∏≤‡∏°‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó:</strong></li>
<li>‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ ‚Üí "‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£"</li>
<li>‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö ‚Üí "‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ"</li>
<li>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà login ‚Üí "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö"</li>
<li>login ‡πÅ‡∏•‡πâ‡∏ß ‚Üí "Logout" (‡∏•‡πâ‡∏≤‡∏á SharedPreferences + signOut)</li>
</ul>
<hr />
<h1 id="10-route-pagedart-253">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 10: <code>route-page.dart</code> (253 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á (‡∏î‡∏π‡∏£‡∏π‡∏õ)</h1>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 11‚Äì31: State
</code></pre></div>

<ul>
<li><code>_selectedRouteView</code> = 0 (‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°), 1 (‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≠), 2 (‡∏´‡∏≠‡πÉ‡∏ô), 3 (ICT)</li>
<li><code>_currentRouteImage</code> ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏à‡∏≤‡∏Å assets ‡∏ï‡∏≤‡∏° index</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 34‚Äì116: build()
</code></pre></div>

<ul>
<li><code>InteractiveViewer</code> ‚Üí ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ã‡∏π‡∏°‡πÑ‡∏î‡πâ (pinch zoom, min 0.5x max 5x)</li>
<li>‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏£‡∏≠‡∏á 4 ‡∏õ‡∏∏‡πà‡∏°: ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° (‡∏°‡πà‡∏ß‡∏á), ‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≠ (‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß), ‡∏´‡∏≠‡πÉ‡∏ô (‡πÅ‡∏î‡∏á), ICT (‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô)</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 119‚Äì138: _routeFilterButton()
</code></pre></div>

<ul>
<li>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏° ElevatedButton ‡∏û‡∏£‡πâ‡∏≠‡∏° animation (‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏≤‡∏ß + ‡πÄ‡∏á‡∏≤ ‡πÄ‡∏°‡∏∑‡πà‡∏≠ selected)</li>
</ul>
<hr />
<h1 id="11-feedback-pagedart-356-feedback">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 11: <code>feedback-page.dart</code> (356 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡πà‡∏á Feedback</h1>
<div class="codehilite"><pre><span></span><code><span class="err">‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</span><span class="w"> </span><span class="mi">5</span><span class="p">:</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">FeedbackMode</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">complain</span><span class="p">,</span><span class="w"> </span><span class="n">rating</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>

<ul>
<li>2 ‡πÇ‡∏´‡∏°‡∏î: ‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏´‡∏£‡∏∑‡∏≠ ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 30‚Äì185: build()
</code></pre></div>

<ul>
<li>‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏•‡∏±‡∏ö Complain/Rating</li>
<li>‡∏ñ‡πâ‡∏≤ Rating: ‡πÅ‡∏™‡∏î‡∏á‡∏î‡∏≤‡∏ß 5 ‡∏î‡∏ß‡∏á + ‡∏ä‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</li>
<li>‡∏ñ‡πâ‡∏≤ Complain: ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤</li>
<li>‡∏õ‡∏∏‡πà‡∏° Submit ‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 187‚Äì230: _onSubmit()
</code></pre></div>

<ol>
<li>Validate: ‡∏ñ‡πâ‡∏≤ rating mode ‚Üí ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡∏≤‡∏ß, ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</li>
<li>‡∏™‡∏£‡πâ‡∏≤‡∏á Map data: <code>{ message, type, timestamp, rating? }</code></li>
<li>‡∏™‡πà‡∏á‡πÑ‡∏õ Firestore collection <code>'feedback'</code></li>
<li>‡πÅ‡∏™‡∏î‡∏á SnackBar "‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢"</li>
</ol>
<hr />
<h1 id="12-busstop_map_pagedart-269">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 12: <code>busstop_map_page.dart</code> (269 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡πâ‡∏≤‡∏¢</h1>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 29‚Äì53: _fetchBusStops()
</code></pre></div>

<ul>
<li>‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡πâ‡∏≤‡∏¢‡∏à‡∏≤‡∏Å Firestore ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô Marker ‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 56‚Äì76: didChangeDependencies()
</code></pre></div>

<ul>
<li>‡∏£‡∏±‡∏ö arguments ‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤ BusStop (lat, long, name, id)</li>
<li>‡∏¢‡πâ‡∏≤‡∏¢‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏õ‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å + ‡πÄ‡∏õ‡∏¥‡∏î Popup ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 80‚Äì130: _buildRouteChips()
</code></pre></div>

<ul>
<li>‡∏™‡∏£‡πâ‡∏≤‡∏á Chip ‡∏™‡∏µ‡∏ï‡∏≤‡∏°‡∏™‡∏≤‡∏¢: S1=‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß, S2=‡πÅ‡∏î‡∏á, S3=‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô</li>
<li>‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á List ‡πÅ‡∏•‡∏∞ String</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 132‚Äì267: build()
</code></pre></div>

<ul>
<li><code>FlutterMap</code> ‡∏û‡∏£‡πâ‡∏≠‡∏° OpenStreetMap tiles</li>
<li><strong>Layer 1:</strong> Marker ‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏ñ‡∏ó‡∏∏‡∏Å‡∏õ‡πâ‡∏≤‡∏¢ (‡∏Å‡∏î‡∏î‡∏π Popup ‡∏ä‡∏∑‡πà‡∏≠+‡∏™‡∏≤‡∏¢)</li>
<li><strong>Layer 2:</strong> ‡∏´‡∏°‡∏∏‡∏î‡πÅ‡∏î‡∏á‡∏õ‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏õ‡πâ‡∏≤‡∏¢‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (‡πÉ‡∏ä‡πâ <code>IgnorePointer</code> ‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏ó‡∏∞‡∏•‡∏∏‡πÑ‡∏î‡πâ)</li>
<li>FAB ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</li>
</ul>
<hr />
<h1 id="13-busstop-pagedart-819">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 13: <code>busstop-page.dart</code> (819 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏ñ</h1>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 14‚Äì55: State
</code></pre></div>

<ul>
<li><code>_selectedLine</code> = ‡∏™‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (yellow/red/blue)</li>
<li><code>_searchQuery</code> = ‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</li>
<li><code>_targetHighlightName</code> = ‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á highlight (‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡∏™‡πà‡∏á‡∏°‡∏≤)</li>
<li><code>_shouldScroll</code> = flag ‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏´‡∏≤‡∏õ‡πâ‡∏≤‡∏¢‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏´‡∏°</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 57‚Äì106: didChangeDependencies() + _handleRouteIdSwitch()
</code></pre></div>

<ul>
<li>‡∏£‡∏±‡∏ö arguments ‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô (‡∏ä‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≤‡∏¢, ‡∏™‡∏≤‡∏¢)</li>
<li>‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Tab ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏™‡∏≤‡∏¢</li>
</ul>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 113‚Äì473: build()
</code></pre></div>

<ul>
<li>‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏¢ 3 ‡∏õ‡∏∏‡πà‡∏° (‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏™‡∏µ S1/S2/S3)</li>
<li>‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏õ‡πâ‡∏≤‡∏¢</li>
<li><code>StreamBuilder</code> ‡∏ü‡∏±‡∏á Firestore ‚Üí ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠ ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≤‡∏¢</li>
<li><strong>Auto-scroll</strong> ‡πÑ‡∏õ‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà highlight (‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å index √ó 75px)</li>
</ul>
<hr />
<h1 id="14-plan-pagedart-1512">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 14: <code>plan-page.dart</code> (1,512 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á</h1>
<p>‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‚Äî ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</p>
<ul>
<li><strong>Dropdown ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á-‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á</strong> ‡∏à‡∏≤‡∏Å‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å Firestore</li>
<li><strong>‡∏Å‡∏î‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</strong> ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å <code>RoutePlannerService.findAllRoutes()</code></li>
<li><strong>‡∏ß‡∏≤‡∏î‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á</strong> ‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà (‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà GeoJSON coordinates)</li>
<li><strong>‡πÅ‡∏™‡∏î‡∏á Route Result Cards</strong> (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ + ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 2, 3)</li>
<li><strong>Timeline UI</strong> ‡πÅ‡∏™‡∏î‡∏á node ‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á ‚Üí ‡∏à‡∏∏‡∏î‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‚Üí ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏µ‡∏™‡∏≤‡∏¢</li>
</ul>
<hr />
<h1 id="15-change_route_pagedart-624">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 15: <code>change_route_page.dart</code> (624 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö</h1>
<ul>
<li><strong>‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö</strong> (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô SharedPreferences)</li>
<li><strong>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏ñ + ‡∏™‡∏≤‡∏¢</strong> ‡∏à‡∏≤‡∏Å Dropdown</li>
<li><strong>‡∏à‡∏≠‡∏á‡∏£‡∏ñ</strong> ‚Üí ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ RTDB path <code>GPS/{busId}</code> (‡∏Ñ‡πà‡∏≤: driverName, routeColor)</li>
<li><strong>‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏£‡∏ñ</strong> ‚Üí ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å RTDB</li>
<li><strong>‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏ñ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</strong> (‡∏ß‡πà‡∏≤‡∏á/‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á)</li>
</ul>
<hr />
<h1 id="16-manager_pagedart-1007">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 16: <code>manager_page.dart</code> (1,007 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</h1>
<ul>
<li><strong>Tab 1 ‚Äî Feedback Report:</strong></li>
<li>‡∏î‡∏∂‡∏á feedback ‡∏à‡∏≤‡∏Å Firestore</li>
<li>‡∏Å‡∏£‡∏≠‡∏á: ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î / ‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô / ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô + ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏≤‡∏¢</li>
<li>‡πÅ‡∏™‡∏î‡∏á Card ‡πÅ‡∏ï‡πà‡∏•‡∏∞ feedback ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏î‡∏≤‡∏ß rating</li>
<li>
<p>‡∏Å‡∏î‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏ô Dialog</p>
</li>
<li>
<p><strong>Tab 2 ‚Äî Driver Report:</strong></p>
</li>
<li>‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å RTDB path <code>'GPS'</code></li>
<li>‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö + ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ active/offline + ‡∏™‡∏≤‡∏¢ + ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏ñ</li>
<li>‡∏Å‡∏î‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏ô Dialog</li>
</ul>
<hr />
<h1 id="17-upbus-pagedart-1373-live-map">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 17: <code>upbus-page.dart</code> (1,373 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å LIVE MAP ‚≠ê</h1>
<p>‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÅ‡∏≠‡∏õ ‚Äî ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</p>
<ul>
<li><strong>‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á</strong> ‡∏à‡∏≤‡∏Å GeoJSON 3 ‡πÑ‡∏ü‡∏•‡πå + ‡∏î‡∏∂‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡∏à‡∏≤‡∏Å Firestore + ‡∏ü‡∏±‡∏á RTDB</li>
<li><strong>FlutterMap</strong> ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà OpenStreetMap + Polyline ‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á + Marker ‡∏£‡∏ñ + Marker ‡∏õ‡πâ‡∏≤‡∏¢</li>
<li><strong>‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏£‡∏≠‡∏á‡∏™‡∏≤‡∏¢</strong> (Green/Red/Blue) + toggle ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î</li>
<li><strong>Dialog ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢</strong> ‚Üí ‡∏î‡∏∂‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡∏à‡∏≤‡∏Å Firestore ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å <code>setDestination()</code></li>
<li><strong>Dialog ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏¢‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</strong> ‚Üí ‡∏ó‡∏∏‡∏Å‡∏™‡∏≤‡∏¢ / ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏µ + ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î</li>
<li><strong>Proximity Alert Box</strong> ‚Üí ‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏ñ‡πÉ‡∏Å‡∏•‡πâ‡∏ñ‡∏∂‡∏á + countdown ETA + animation ‡∏Å‡∏£‡∏∞‡∏û‡∏£‡∏¥‡∏ö</li>
<li><strong>Bottom Navigation</strong> ‚Üí 5 ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô (Map, Stop, Route, Plan, Feed)</li>
</ul>
<hr />
<h1 id="18-global_debug_bardart-15-debug-wrapper">üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 18: <code>global_debug_bar.dart</code> (15 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Äî Debug Wrapper (‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß)</h1>
<div class="codehilite"><pre><span></span><code>‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 4‚Äì14: class GlobalDebugBarWrapper
</code></pre></div>

<ul>
<li>‡πÄ‡∏õ‡πá‡∏ô StatelessWidget ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö <code>child</code> ‡πÅ‡∏•‡πâ‡∏ß return <code>child</code> ‡∏ï‡∏£‡∏á‡πÜ</li>
<li><strong>‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£</strong> (debug bar ‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß) ‚Äî ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ error</li>
</ul>
<hr />
<h1 id="dependencies">üìä ‡∏™‡∏£‡∏∏‡∏õ Dependencies ‡∏´‡∏•‡∏±‡∏Å</h1>
<table>
<thead>
<tr>
<th>Package</th>
<th>‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>firebase_core</code></td>
<td>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Firebase</td>
</tr>
<tr>
<td><code>cloud_firestore</code></td>
<td>‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Firestore (‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏ñ, Feedback)</td>
</tr>
<tr>
<td><code>firebase_database</code></td>
<td>Realtime Database (‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á GPS ‡∏£‡∏ñ)</td>
</tr>
<tr>
<td><code>firebase_auth</code></td>
<td>‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô (Email/Password)</td>
</tr>
<tr>
<td><code>flutter_map</code></td>
<td>‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà OpenStreetMap</td>
</tr>
<tr>
<td><code>latlong2</code></td>
<td>‡∏Ñ‡∏•‡∏≤‡∏™‡∏û‡∏¥‡∏Å‡∏±‡∏î LatLng</td>
</tr>
<tr>
<td><code>geolocator</code></td>
<td>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° GPS ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</td>
</tr>
<tr>
<td><code>flutter_local_notifications</code></td>
<td>Push Notification ‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</td>
</tr>
<tr>
<td><code>vibration</code></td>
<td>‡∏™‡∏±‡πà‡∏ô‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</td>
</tr>
<tr>
<td><code>provider</code></td>
<td>State Management (‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πâ‡∏≤‡∏°‡∏´‡∏ô‡πâ‡∏≤)</td>
</tr>
<tr>
<td><code>shared_preferences</code></td>
<td>‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö)</td>
</tr>
<tr>
<td><code>http</code></td>
<td>‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API</td>
</tr>
<tr>
<td><code>flutter_map_animations</code></td>
<td>Animation ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà</td>
</tr>
</tbody>
</table>
<hr />
<h1 id="flow">üîÑ Flow ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°</h1>
<div class="codehilite"><pre><span></span><code>‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ
  ‚Üí main.dart ‡∏™‡∏£‡πâ‡∏≤‡∏á GlobalLocationService + Firebase
  ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤ UpBusHomePage (Live Map)
    ‚Üí ‡πÇ‡∏´‡∏•‡∏î GeoJSON ‚Üí ‡∏ß‡∏≤‡∏î‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á
    ‚Üí ‡∏ü‡∏±‡∏á RTDB ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏£‡∏ñ real-time
    ‚Üí ‡∏ü‡∏±‡∏á GPS ‚Üí ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢
  ‚Üí setDestination() ‚Üí ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞ ‚Üí ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á
  ‚Üí ‡∏ñ‡πâ‡∏≤ ETA ‚â§ 5/3/1 ‡∏ô‡∏≤‡∏ó‡∏µ ‡∏´‡∏£‡∏∑‡∏≠ ‚â§ 250m ‚Üí ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (notification + ‡∏™‡∏±‡πà‡∏ô)

‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏î‡πÅ‡∏û‡∏•‡∏ô
  ‚Üí PlanPage ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á + ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á
  ‚Üí RoutePlannerService.findAllRoutes()
  ‚Üí ‡πÅ‡∏™‡∏î‡∏á 3 ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏° Weighted Score

‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
  ‚Üí LoginPage ‚Üí Firebase Auth ‚Üí ChangeRoutePage
  ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏ñ + ‡∏™‡∏≤‡∏¢ ‚Üí ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô RTDB
  ‚Üí ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á GPS ‡∏ñ‡∏π‡∏Å‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏õ‡∏ó‡∏∏‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
  ‚Üí LoginPage ‚Üí Firebase Auth ‚Üí ManagerPage
  ‚Üí ‡∏î‡∏π Feedback + Driver Report
</code></pre></div>
</div>
</body>
</html>